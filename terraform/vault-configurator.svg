<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="722px" height="567px" viewBox="-0.5 -0.5 722 567" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2021-03-16T22:20:04.969Z&quot; agent=&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_16_0) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/12.4.2 Chrome/78.0.3904.130 Electron/7.1.4 Safari/537.36&quot; etag=&quot;JNZVy_gxhQM3aB3-UHCw&quot; version=&quot;12.4.2&quot; type=&quot;device&quot; pages=&quot;1&quot;&gt;&lt;diagram id=&quot;lbTzuTaBQZwT-Yp7fSB9&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;"><defs/><g><rect x="410" y="106" width="310" height="440" fill="#ffffff" stroke="#d8d8d8" stroke-width="2" pointer-events="all"/><g transform="translate(649.5,528.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="66" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Mark Pro&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 67px; white-space: nowrap; overflow-wrap: normal; text-align: right;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#004153" face="Mark Pro"><b>Kubernetes</b></font></div></div></foreignObject><text x="33" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Mark Pro">[Not supported by viewer]</text></switch></g><rect x="420" y="396" width="240" height="110" fill="#ffffff" stroke="#d8d8d8" stroke-width="2" pointer-events="all"/><g transform="translate(506.5,488.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="149" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Hack; color: rgb(244, 244, 244); line-height: 1.2; vertical-align: top; width: 150px; white-space: nowrap; overflow-wrap: normal; text-align: right;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#004153" face="Mark Pro"><b>Namespace: kube-system</b></font></div></div></foreignObject><text x="75" y="12" fill="#F4F4F4" text-anchor="middle" font-size="12px" font-family="Hack">[Not supported by viewer]</text></switch></g><rect x="220" y="111" width="80" height="80" fill="#ff9c66" stroke="none" pointer-events="all"/><g transform="translate(238.5,142.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="42" height="17" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 65, 83); line-height: 1.2; vertical-align: top; width: 42px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font face="Mark Pro" style="font-size: 16px">Vault</font></b></div></div></foreignObject><text x="21" y="15" fill="#004153" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="420" y="116" width="240" height="260" fill="#ffffff" stroke="#d8d8d8" stroke-width="2" pointer-events="all"/><g transform="translate(473.5,358.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="182" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Hack; color: rgb(244, 244, 244); line-height: 1.2; vertical-align: top; width: 183px; white-space: nowrap; overflow-wrap: normal; text-align: right;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#004153" face="Mark Pro"><b>Namespace: vault-configurator</b></font></div></div></foreignObject><text x="91" y="12" fill="#F4F4F4" text-anchor="middle" font-size="12px" font-family="Hack">[Not supported by viewer]</text></switch></g><rect x="570" y="126" width="80" height="50" fill="#004153" stroke="none" pointer-events="all"/><g transform="translate(575.5,137.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="68" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 156, 102); line-height: 1.2; vertical-align: top; width: 68px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font style="font-size: 9px"><b><font face="Mark Pro">ServiceAccount<br />vault-auth</font><br /></b></font></div></div></foreignObject><text x="34" y="19" fill="#FF9C66" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="570" y="406" width="80" height="50" fill="#ff9c66" stroke="none" pointer-events="all"/><g transform="translate(598.5,417.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 65, 83); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font face="Mark Pro">K8s<br />API</font><br /></b></div></div></foreignObject><text x="11" y="19" fill="#004153" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="570" y="266" width="80" height="50" fill="#004153" stroke="none" pointer-events="all"/><g transform="translate(575.5,277.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="68" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 156, 102); line-height: 1.2; vertical-align: top; width: 68px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font style="font-size: 9px"><b><font face="Mark Pro">ServiceAccount<br />terraform</font><br /></b></font></div></div></foreignObject><text x="34" y="19" fill="#FF9C66" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="90" y="16" width="540" height="40" fill="none" stroke="none" pointer-events="all"/><g transform="translate(256.5,-0.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="206" height="73" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Mark Pro&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 208px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><h1><font color="#004153" style="font-size: 36px" face="Mark Pro">Prepare k8s</font></h1></div></div></foreignObject><text x="103" y="43" fill="#000000" text-anchor="middle" font-size="12px" font-family="Mark Pro">[Not supported by viewer]</text></switch></g><rect x="0" y="246" width="390" height="320" fill="none" stroke="none" pointer-events="all"/><g transform="translate(0.5,237.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="390" height="326" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: &quot;Mark Pro&quot;; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 390px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><ul><li><b style="color: rgb(0 , 65 , 83)">Create Namespace </b><font style="color: rgb(0 , 65 , 83)"><font face="Hack">vault-configurator</font><br /><br /></font></li></ul><font style="color: rgb(0 , 65 , 83)" face="Mark Pro"><br /></font><div><ul><li><font color="#004153" face="Mark Pro"><b>Bootstrap Vault by running the bootstrap Terraform-Skript once manually:</b></font></li><ul><li><font color="#004153" face="Mark Pro"><b>activate Kubernetes-Auth</b></font></li><ul><li><font color="#004153" face="Mark Pro"><b>get K8s-API CA-Cert from K8s-API</b></font></li><li><font color="#004153"><b>create ServiceAccoun </b><font face="Hack">vault-auth</font></font></li><li><font color="#004153"><b>get K8s-Token from ServiceAccount </b><font face="Hack">vault-auth</font></font></li></ul><li><font color="#004153"><b>create Vault-Policy<font face="Hack"> </font></b><font face="Hack">vault_configurator</font><b> that tokens should get when K8s-Auth returns ServiceAccount </b><font face="Hack">terraform</font><b> in namespace </b><font face="Hack">vault-configurator</font><b> (basically, it needs to be able to do nearly everything as this will configure Vault)</b></font></li><li><font color="#004153" face="Mark Pro"><b>save state in Kubernetes Secret "tfstate-default-state"</b></font></li></ul><li><font color="#004153" face="Mark Pro"><b>after that, run terraform as a Kubernetes-Job whenever a pull request was approved</b></font></li></ul></div><div><br /></div></div></div></foreignObject><text x="195" y="169" fill="#000000" text-anchor="middle" font-size="12px" font-family="Mark Pro">[Not supported by viewer]</text></switch></g><rect x="426" y="402" width="232" height="102" fill-opacity="0.8" fill="#ffffff" stroke="none" pointer-events="all"/><rect x="570" y="206" width="80" height="50" fill="#004153" stroke="none" pointer-events="all"/><g transform="translate(570.5,210.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="78" height="40" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 156, 102); line-height: 1.2; vertical-align: top; width: 78px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font size="1" face="Mark Pro"><b>Secret<br />tfstate-default-state</b></font></div></div></foreignObject><text x="39" y="26" fill="#FF9C66" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g></g></svg>